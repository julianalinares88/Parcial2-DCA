(()=>{"use strict";var t,e;(e=t||(t={})).ADD_TO_CART="ADD_TO_CART",e.REMOVE_FROM_CART="REMOVE_FROM_CART",e.GET_PRODUCTS="GET_PRODUCTS";let n=(t=>{const e=localStorage.getItem(t)||sessionStorage.getItem(t);return e?JSON.parse(e):{screen:"DASHBOARD",cart:[],products:[]}})("STORE"),o=[];const r=e=>{const r=((e,n)=>{const{action:o,payload:r}=e;switch(o){case t.ADD_TO_CART:return Object.assign(Object.assign({},n),{cart:[...n.cart,r]});case t.REMOVE_FROM_CART:const e=n.cart.filter((t=>t.uid!==r));return Object.assign(Object.assign({},n),{cart:e});case t.GET_PRODUCTS:return Object.assign(Object.assign({},n),{products:r});default:return n}})(e,JSON.parse(JSON.stringify(n)));n=r,((t,e,n=!1)=>{const o=n?sessionStorage:localStorage,r=JSON.stringify(e);o.setItem(t,r)})("STORE",r),o.forEach((t=>t.render()))},c=t=>{o=[...o,t]};const i=()=>{return e=void 0,n=void 0,r=function*(){const e=yield(n=void 0,o=void 0,r=void 0,c=function*(){try{const t=yield fetch("https://fakestoreapi.com/products");return yield t.json()}catch(t){return console.error(t),[]}},new(r||(r=Promise))((function(t,e){function i(t){try{a(c.next(t))}catch(t){e(t)}}function s(t){try{a(c.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(i,s)}a((c=c.apply(n,o||[])).next())})));var n,o,r,c;return{action:t.GET_PRODUCTS,payload:e}},new((o=void 0)||(o=Promise))((function(t,c){function i(t){try{a(r.next(t))}catch(t){c(t)}}function s(t){try{a(r.throw(t))}catch(t){c(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,s)}a((r=r.apply(e,n||[])).next())}));var e,n,o,r};var s;!function(t){t.uid="uid",t.ptitle="ptitle",t.image="image",t.description="description",t.category="category",t.price="price",t.rating="rating"}(s||(s={}));class a extends HTMLElement{static get observedAttributes(){return Object.keys({uid:null,ptitle:null,image:null,description:null,category:null,price:null,rating:null})}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}attributeChangedCallback(t,e,n){switch(t){case s.uid:this.uid=n?Number(n):void 0;break;case s.price:this.price=n?Number(n):void 0;break;case s.rating:this.rating=n?Number(n):void 0;break;default:this[t]=n}this.render()}render(){var e,n;if(!this.shadowRoot)return;this.shadowRoot.innerHTML=`\n\n        \n            <div class="product-card">\n                <h3>Category: ${this.ptitle||""}</h3>\n                <img src="${this.image||""}" alt="Product Image">\n                <h2>${this.description||""}</h2>\n                <p>Category: ${this.category||""}</p>\n                <p>Price: $${this.price||""}</p>\n                <p>Rating: ${this.rating||""}</p>\n                <button>Delete Product</button>\n            </div>\n        `;const o=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector(".delete-product");null===(n=this.shadowRoot)||void 0===n||n.querySelector(".check-prodcut"),null==o||o.addEventListener("click",(()=>{var e;console.log("click",this.uid),r((e=this.uid,{action:t.REMOVE_FROM_CART,payload:e}))}))}}customElements.define("product-component",a);class d extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),c(this)}connectedCallback(){return t=this,e=void 0,c=function*(){if(console.log("Dashboard connected"),n.products&&0!==n.products.length)console.log("Products already loaded:",n.products);else{const t=yield i();r(t),console.log("Products state after fetch:",n.products)}this.render()},new((o=void 0)||(o=Promise))((function(n,r){function i(t){try{a(c.next(t))}catch(t){r(t)}}function s(t){try{a(c.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(i,s)}a((c=c.apply(t,e||[])).next())}));var t,e,o,c}fetchProducts(){try{if(!n.products||0===n.products.length)return console.log("No products available in the state."),null;const t=this.ownerDocument.createElement("section");return t.className="products-container",n.products.forEach((e=>{const n=this.ownerDocument.createElement("product-component");n.setAttribute(s.uid,e.id.toString()),n.setAttribute(s.image,e.image),n.setAttribute(s.description,e.title),n.setAttribute(s.category,e.category),n.setAttribute(s.price,e.price.toString()),n.setAttribute(s.rating,e.rating.rate.toString()),t.appendChild(n)})),console.log("Products rendered:",n.products),t}catch(t){return console.error("Error rendering products:",t),null}}render(){if(this.shadowRoot){this.shadowRoot.innerHTML="\n            \n            \n            ";const t=this.ownerDocument.createElement("h2");t.textContent="Product List",this.shadowRoot.appendChild(t);const e=this.fetchProducts();e?this.shadowRoot.appendChild(e):this.shadowRoot.innerHTML+="<p>no encontre los productos :( </p>"}}}customElements.define("app-dashboard",d);class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),c(this)}connectedCallback(){this.render(),console.log(n)}render(){var t;if(this.shadowRoot&&(this.shadowRoot.innerHTML=""),"DASHBOARD"===n.screen){const e=document.createElement("app-dashboard");null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}else console.log("Not found")}}customElements.define("app-container",u)})();